source(Main)

data <- read.table("/media/igna/Elements/HotelDieu/Cochrane/MetaMapBurden/Trial_Burden_Param/NCT_data_tot.txt")
MMap <- read.table("/media/igna/Elements/HotelDieu/Cochrane/MetaMapBurden/Trial_Burden_Param/MMap_tot.txt")

#Taxonomy RL
Tax <- "DL"
L <- Data_upl(Tax)

Mgbd <- L[[1]]
Egbd <- L[[2]]
MT <- L[[3]]
MTEB <- L[[4]]
remove(L)

NCTs <- tolower(as.character(data$PMID))
alpha <- 0.02

A <- Test_add_MT(NCTs,MMap,MT,MTEB,alpha)
#A[[1]] = TRUE
MTc <- A[[2]]
remove(A)
remove(MT)
remove(MTEB)

MC <- CUI_charac(Mgbd, Egbd, MMap, MTc)

#Classification without SVM
wsd <- "Yes"


i <- 1
NCT <- paste("pbky",NCTs[i],sep="")
D <- Trial_charac(Mgbd,Egbd,NCT,MMap,MC,wsd)
for(i in 2:length(NCTs)){
NCT <- paste("pbky",NCTs[i],sep="")
D <- rbind(D,Trial_charac(Mgbd,Egbd,NCT,MMap,MC,wsd))
}
#30s pour 1500 essais

D <- data.frame(D,row.names=NULL)
D <- cbind(D,Nb_mots_chp(data))

gbd <- as.character(D$Ess_GBD)





MC <- CUI_charac(Mgbd, Egbd, MMap, MTc)


classifier_nosvm <- function(Tax, data, MMap, alpha, wsd){

#Depending on the taxonomy, we upload the data of IntraMap and E_B enrichment
L <- Data_upl(Tax)
Mgbd <- L[[1]]
Egbd <- L[[2]]
MT <- L[[3]]
MTEB <- L[[4]]
remove(L)

NCTs <- tolower(as.character(data$PMID))
A <- Test_add_MT(NCTs,MMap,MT,MTEB,alpha)
#if A[[1]] == TRUE
MTc <- A[[2]]
remove(A)
remove(MT)
remove(MTEB)

MC <- CUI_charac(Mgbd, Egbd, MMap, MTc)

#On fait le processing pour chaque essai pour wsd

i <- 1
NCT <- paste("pbky",NCTs[i],sep="")
D <- Trial_charac(Mgbd,Egbd,NCT,MMap,MC,wsd)
for(i in 2:length(NCTs)){
NCT <- paste("pbky",NCTs[i],sep="")
D <- rbind(D,Trial_charac(Mgbd,Egbd,NCT,MMap,MC,wsd))
}
#30s pour 1500 essais

D <- data.frame(D,row.names=NULL)
D <- cbind(D,Nb_mots_chp(data))

gbd <- as.character(D$Ess_GBD)

return(gbd)

}





gbd_svm1 <- as.character(D$Ess_GBD)
gbd[D$Ess_GBD!=""][as.logical(is_unclear)] <- ""


